

class BoxController(object):

    def __init__(self, model):
        """
        :param object model: holds the data of this call
        :param function callback: if set, this function will be called when any button is pressed.
        """
        self.model = model

    # Methods executing when a key is pressed -------------------------------
    # If cancel, x, or escape, close ui and return None
    def x_pressed(self):
        self.nothing_selected_and_stop()

    def escape_pressed(self, event):
        self.nothing_selected_and_stop()

    def button_pressed(self, choice):
        # If cancel
        if choice.is_cancel:
            self.nothing_selected_and_stop()
        else:
            # So there has been a choice selected
            self.model.choices.selected_choice = choice
            self.model.check_callback_updated()

    def hotkey_pressed(self, keysym, keychar):
        """
        Handle an event that is generated by a person interacting with a button.  It may be a button press
        or a key press.

        TODO: Enhancement: Allow hotkey to be specified in filename of image as a shortcut too!!!
        """
        if keysym != keychar:  # A special character
            hotkey_pressed = '<{}>'.format(keysym)
        else:
            hotkey_pressed = keysym

        choice_found = self.model.choices.select_choice_from_hotkey(hotkey_pressed)

        # If hotkey is in uppercase, it will work if the lowercase key is pressed
        if not choice_found:
            choice_found = self.model.choices.select_choice_from_hotkey(hotkey_pressed.upper())

        if choice_found:
            self.model.check_callback_updated()
        else:
            print("Event not understood")

    def image_pressed(self, filename, row, column):
        self.model.choices.unselect_choice()
        self.model.row_column_selected = (row, column)
        self.model.check_callback_updated()

    def nothing_selected_and_stop(self):
        self.model.choices.unselect_choice()
        self.model.row_column_selected = None
        self.model.stop = True
        self.model.model_updated()

